# CloudSentinel
 
CloudSentinel is a lightweight, demo-friendly tool that helps defenders spot risky AWS IAM configurations and surface escalation-ready role chains. It has three parts:

Collector (collect_iam.py) — pulls IAM roles, trust policies, and managed/inline policy documents via boto3

Analyzer (analyzer.py) — runs simple rules (R1–R3) over policies and trust docs to produce findings

ASCII Reporter (report_ascii.py) — renders an easy-to-read table and “Top Exploitable Chains”

A single CLI wrapper, cloudsentinel.py, orchestrates those parts or lets you run each stage standalone.

 This is a prototype for blue-team demos and education. It’s intentionally conservative and not a substitute for full IAM analysis. Validate results before acting.

Features (what it catches today)

R1 – PassRole misuse
iam:PassRole on Resource: * (inline or managed policy)

R2 – Service wildcards
Admin-like service:* on Resource: * for key services (iam, sts, ec2, s3, lambda) with severity weighting (IAM/STS → HIGH, others → MEDIUM)

R3 – Broad/unsafe trust
Role trust policy allows Principal: "*", or an entire account :root without conditions

Escalation-ready detection
If a role has PassRole and a launcher capability (e.g., ec2:RunInstances, lambda:CreateFunction, ecs:RunTask, or the service:* wildcard), it’s flagged with a suggested exploit path.